BED Classifier.
	One Head.
	Weighted for Precision.
	Brevitas Default.
	Dataset images divided by 255.


Datasets Length
	Train and Val: 128

Load Model: False

Device: cuda
Optimizer:
	Learning Rate: 0.001
	Weight Decay: 0.001
Scheduler:
	Scheduler factor: 0.8
	Scheduler patience: 2
	Scheduler threshold: 0.001
	Scheduler min learning rate: 1e-06

Batch Size: 64
Num Workers: 8
Pin Memory: True
Epochs: 5

IMG DIMS:
	Width: 112
	Height: 112

Brevitas Config:
	Fixed Point: True
	Weights Bit Width: 4
	Big Layers Weights Bit Width: 4
	Bias Bit Width: 4
	Activations Bit Width: 4

Trainable parameters = 68914
Total parameters = 68914

==================================================================================================================================
Layer (type:depth-idx)                                                           Output Shape              Param #
==================================================================================================================================
MobileNetV2_MINI_112                                                             [1, 2]                    --
├─Sequential: 1-1                                                                [1, 64, 7, 7]             60,206
│    └─QuantIdentity: 2-1                                                        [1, 3, 112, 112]          --
│    │    └─ActQuantProxyFromInjector: 3-1                                       [1, 3, 112, 112]          --
│    │    └─ActQuantProxyFromInjector: 3-2                                       [1, 3, 112, 112]          1
├─Sequential: 1-62                                                               --                        (recursive)
│    └─QuantReLU: 2-73                                                           --                        (recursive)
│    │    └─ActQuantProxyFromInjector: 3-76                                      --                        (recursive)
├─Sequential: 1-63                                                               --                        (recursive)
│    └─QuantIdentity: 2-3                                                        --                        (recursive)
│    │    └─ActQuantProxyFromInjector: 3-4                                       --                        (recursive)
│    └─Sequential: 2-4                                                           [1, 32, 56, 56]           --
│    │    └─QuantConv2d: 3-5                                                     [1, 32, 56, 56]           864
│    │    └─BatchNorm2d: 3-6                                                     [1, 32, 56, 56]           64
│    │    └─QuantReLU: 3-7                                                       [1, 32, 56, 56]           1
├─Sequential: 1-62                                                               --                        (recursive)
│    └─QuantReLU: 2-73                                                           --                        (recursive)
│    │    └─ActQuantProxyFromInjector: 3-76                                      --                        (recursive)
├─Sequential: 1-63                                                               --                        (recursive)
│    └─Sequential: 2-6                                                           --                        (recursive)
│    │    └─QuantReLU: 3-9                                                       --                        (recursive)
│    └─InvertedBlock: 2-7                                                        [1, 8, 56, 56]            --
│    │    └─Sequential: 3-10                                                     [1, 8, 56, 56]            626
├─Sequential: 1-62                                                               --                        (recursive)
│    └─QuantReLU: 2-73                                                           --                        (recursive)
│    │    └─ActQuantProxyFromInjector: 3-76                                      --                        (recursive)
├─Sequential: 1-63                                                               --                        (recursive)
│    └─InvertedBlock: 2-11                                                       --                        (recursive)
│    │    └─Sequential: 3-14                                                     --                        (recursive)
├─Sequential: 1-62                                                               --                        (recursive)
│    └─QuantReLU: 2-73                                                           --                        (recursive)
│    │    └─ActQuantProxyFromInjector: 3-76                                      --                        (recursive)
├─Sequential: 1-63                                                               --                        (recursive)
│    └─InvertedBlock: 2-11                                                       --                        (recursive)
│    │    └─Sequential: 3-14                                                     --                        (recursive)
│    └─InvertedBlock: 2-12                                                       [1, 16, 28, 28]           --
│    │    └─Sequential: 3-15                                                     [1, 16, 28, 28]           627
├─Sequential: 1-62                                                               --                        (recursive)
│    └─QuantReLU: 2-73                                                           --                        (recursive)
│    │    └─ActQuantProxyFromInjector: 3-76                                      --                        (recursive)
├─Sequential: 1-63                                                               --                        (recursive)
│    └─InvertedBlock: 2-18                                                       --                        (recursive)
│    │    └─Sequential: 3-21                                                     --                        (recursive)
├─Sequential: 1-62                                                               --                        (recursive)
│    └─QuantReLU: 2-73                                                           --                        (recursive)
│    │    └─ActQuantProxyFromInjector: 3-76                                      --                        (recursive)
├─Sequential: 1-63                                                               --                        (recursive)
│    └─InvertedBlock: 2-18                                                       --                        (recursive)
│    │    └─Sequential: 3-21                                                     --                        (recursive)
├─Sequential: 1-62                                                               --                        (recursive)
│    └─QuantReLU: 2-73                                                           --                        (recursive)
│    │    └─ActQuantProxyFromInjector: 3-76                                      --                        (recursive)
├─Sequential: 1-63                                                               --                        (recursive)
│    └─InvertedBlock: 2-18                                                       --                        (recursive)
│    │    └─Sequential: 3-21                                                     --                        (recursive)
│    └─InvertedBlock: 2-19                                                       [1, 16, 28, 28]           --
│    │    └─Sequential: 3-22                                                     [1, 16, 28, 28]           1,475
├─Sequential: 1-62                                                               --                        (recursive)
│    └─QuantReLU: 2-73                                                           --                        (recursive)
│    │    └─ActQuantProxyFromInjector: 3-76                                      --                        (recursive)
├─Sequential: 1-63                                                               --                        (recursive)
│    └─InvertedBlock: 2-25                                                       --                        (recursive)
│    │    └─Sequential: 3-28                                                     --                        (recursive)
├─Sequential: 1-62                                                               --                        (recursive)
│    └─QuantReLU: 2-73                                                           --                        (recursive)
│    │    └─ActQuantProxyFromInjector: 3-76                                      --                        (recursive)
├─Sequential: 1-63                                                               --                        (recursive)
│    └─InvertedBlock: 2-25                                                       --                        (recursive)
│    │    └─Sequential: 3-28                                                     --                        (recursive)
├─Sequential: 1-62                                                               --                        (recursive)
│    └─QuantReLU: 2-73                                                           --                        (recursive)
│    │    └─ActQuantProxyFromInjector: 3-76                                      --                        (recursive)
├─Sequential: 1-63                                                               --                        (recursive)
│    └─InvertedBlock: 2-25                                                       --                        (recursive)
│    │    └─Sequential: 3-28                                                     --                        (recursive)
│    └─InvertedBlock: 2-26                                                       [1, 24, 14, 14]           --
│    │    └─Sequential: 3-29                                                     [1, 24, 14, 14]           1,747
├─Sequential: 1-62                                                               --                        (recursive)
│    └─QuantReLU: 2-73                                                           --                        (recursive)
│    │    └─ActQuantProxyFromInjector: 3-76                                      --                        (recursive)
├─Sequential: 1-63                                                               --                        (recursive)
│    └─InvertedBlock: 2-32                                                       --                        (recursive)
│    │    └─Sequential: 3-35                                                     --                        (recursive)
├─Sequential: 1-62                                                               --                        (recursive)
│    └─QuantReLU: 2-73                                                           --                        (recursive)
│    │    └─ActQuantProxyFromInjector: 3-76                                      --                        (recursive)
├─Sequential: 1-63                                                               --                        (recursive)
│    └─InvertedBlock: 2-32                                                       --                        (recursive)
│    │    └─Sequential: 3-35                                                     --                        (recursive)
├─Sequential: 1-62                                                               --                        (recursive)
│    └─QuantReLU: 2-73                                                           --                        (recursive)
│    │    └─ActQuantProxyFromInjector: 3-76                                      --                        (recursive)
├─Sequential: 1-63                                                               --                        (recursive)
│    └─InvertedBlock: 2-32                                                       --                        (recursive)
│    │    └─Sequential: 3-35                                                     --                        (recursive)
│    └─InvertedBlock: 2-33                                                       [1, 24, 14, 14]           --
│    │    └─Sequential: 3-36                                                     [1, 24, 14, 14]           2,979
├─Sequential: 1-62                                                               --                        (recursive)
│    └─QuantReLU: 2-73                                                           --                        (recursive)
│    │    └─ActQuantProxyFromInjector: 3-76                                      --                        (recursive)
├─Sequential: 1-63                                                               --                        (recursive)
│    └─InvertedBlock: 2-39                                                       --                        (recursive)
│    │    └─Sequential: 3-42                                                     --                        (recursive)
├─Sequential: 1-62                                                               --                        (recursive)
│    └─QuantReLU: 2-73                                                           --                        (recursive)
│    │    └─ActQuantProxyFromInjector: 3-76                                      --                        (recursive)
├─Sequential: 1-63                                                               --                        (recursive)
│    └─InvertedBlock: 2-39                                                       --                        (recursive)
│    │    └─Sequential: 3-42                                                     --                        (recursive)
├─Sequential: 1-62                                                               --                        (recursive)
│    └─QuantReLU: 2-73                                                           --                        (recursive)
│    │    └─ActQuantProxyFromInjector: 3-76                                      --                        (recursive)
├─Sequential: 1-63                                                               --                        (recursive)
│    └─InvertedBlock: 2-39                                                       --                        (recursive)
│    │    └─Sequential: 3-42                                                     --                        (recursive)
│    └─InvertedBlock: 2-40                                                       [1, 32, 7, 7]             --
│    │    └─Sequential: 3-43                                                     [1, 32, 7, 7]             6,691
├─Sequential: 1-62                                                               --                        (recursive)
│    └─QuantReLU: 2-73                                                           --                        (recursive)
│    │    └─ActQuantProxyFromInjector: 3-76                                      --                        (recursive)
├─Sequential: 1-63                                                               --                        (recursive)
│    └─InvertedBlock: 2-46                                                       --                        (recursive)
│    │    └─Sequential: 3-49                                                     --                        (recursive)
├─Sequential: 1-62                                                               --                        (recursive)
│    └─QuantReLU: 2-73                                                           --                        (recursive)
│    │    └─ActQuantProxyFromInjector: 3-76                                      --                        (recursive)
├─Sequential: 1-63                                                               --                        (recursive)
│    └─InvertedBlock: 2-46                                                       --                        (recursive)
│    │    └─Sequential: 3-49                                                     --                        (recursive)
├─Sequential: 1-62                                                               --                        (recursive)
│    └─QuantReLU: 2-73                                                           --                        (recursive)
│    │    └─ActQuantProxyFromInjector: 3-76                                      --                        (recursive)
├─Sequential: 1-63                                                               --                        (recursive)
│    └─InvertedBlock: 2-46                                                       --                        (recursive)
│    │    └─Sequential: 3-49                                                     --                        (recursive)
│    └─InvertedBlock: 2-47                                                       [1, 32, 7, 7]             --
│    │    └─Sequential: 3-50                                                     [1, 32, 7, 7]             9,923
├─Sequential: 1-62                                                               --                        (recursive)
│    └─QuantReLU: 2-73                                                           --                        (recursive)
│    │    └─ActQuantProxyFromInjector: 3-76                                      --                        (recursive)
├─Sequential: 1-63                                                               --                        (recursive)
│    └─InvertedBlock: 2-53                                                       --                        (recursive)
│    │    └─Sequential: 3-56                                                     --                        (recursive)
├─Sequential: 1-62                                                               --                        (recursive)
│    └─QuantReLU: 2-73                                                           --                        (recursive)
│    │    └─ActQuantProxyFromInjector: 3-76                                      --                        (recursive)
├─Sequential: 1-63                                                               --                        (recursive)
│    └─InvertedBlock: 2-53                                                       --                        (recursive)
│    │    └─Sequential: 3-56                                                     --                        (recursive)
├─Sequential: 1-62                                                               --                        (recursive)
│    └─QuantReLU: 2-73                                                           --                        (recursive)
│    │    └─ActQuantProxyFromInjector: 3-76                                      --                        (recursive)
├─Sequential: 1-63                                                               --                        (recursive)
│    └─InvertedBlock: 2-53                                                       --                        (recursive)
│    │    └─Sequential: 3-56                                                     --                        (recursive)
│    └─InvertedBlock: 2-54                                                       [1, 32, 7, 7]             --
│    │    └─Sequential: 3-57                                                     [1, 32, 7, 7]             9,923
├─Sequential: 1-62                                                               --                        (recursive)
│    └─QuantReLU: 2-73                                                           --                        (recursive)
│    │    └─ActQuantProxyFromInjector: 3-76                                      --                        (recursive)
├─Sequential: 1-63                                                               --                        (recursive)
│    └─InvertedBlock: 2-60                                                       --                        (recursive)
│    │    └─Sequential: 3-63                                                     --                        (recursive)
├─Sequential: 1-62                                                               --                        (recursive)
│    └─QuantReLU: 2-73                                                           --                        (recursive)
│    │    └─ActQuantProxyFromInjector: 3-76                                      --                        (recursive)
├─Sequential: 1-63                                                               --                        (recursive)
│    └─InvertedBlock: 2-60                                                       --                        (recursive)
│    │    └─Sequential: 3-63                                                     --                        (recursive)
├─Sequential: 1-62                                                               --                        (recursive)
│    └─QuantReLU: 2-73                                                           --                        (recursive)
│    │    └─ActQuantProxyFromInjector: 3-76                                      --                        (recursive)
├─Sequential: 1-63                                                               --                        (recursive)
│    └─InvertedBlock: 2-60                                                       --                        (recursive)
│    │    └─Sequential: 3-63                                                     --                        (recursive)
│    └─InvertedBlock: 2-61                                                       [1, 64, 7, 7]             --
│    │    └─Sequential: 3-64                                                     [1, 64, 7, 7]             7,107
├─Sequential: 1-62                                                               --                        (recursive)
│    └─QuantReLU: 2-73                                                           --                        (recursive)
│    │    └─ActQuantProxyFromInjector: 3-76                                      --                        (recursive)
├─Sequential: 1-63                                                               --                        (recursive)
│    └─InvertedBlock: 2-67                                                       --                        (recursive)
│    │    └─Sequential: 3-70                                                     --                        (recursive)
├─Sequential: 1-62                                                               --                        (recursive)
│    └─QuantReLU: 2-73                                                           --                        (recursive)
│    │    └─ActQuantProxyFromInjector: 3-76                                      --                        (recursive)
├─Sequential: 1-63                                                               --                        (recursive)
│    └─InvertedBlock: 2-67                                                       --                        (recursive)
│    │    └─Sequential: 3-70                                                     --                        (recursive)
├─Sequential: 1-62                                                               --                        (recursive)
│    └─QuantReLU: 2-73                                                           --                        (recursive)
│    │    └─ActQuantProxyFromInjector: 3-76                                      --                        (recursive)
├─Sequential: 1-63                                                               --                        (recursive)
│    └─InvertedBlock: 2-67                                                       --                        (recursive)
│    │    └─Sequential: 3-70                                                     --                        (recursive)
│    └─InvertedBlock: 2-68                                                       [1, 64, 7, 7]             --
│    │    └─Sequential: 3-71                                                     [1, 64, 7, 7]             18,179
├─Sequential: 1-62                                                               --                        (recursive)
│    └─QuantReLU: 2-73                                                           --                        (recursive)
│    │    └─ActQuantProxyFromInjector: 3-76                                      --                        (recursive)
├─Sequential: 1-63                                                               --                        (recursive)
│    └─InvertedBlock: 2-74                                                       --                        (recursive)
│    │    └─Sequential: 3-77                                                     --                        (recursive)
├─Sequential: 1-62                                                               --                        (recursive)
│    └─QuantReLU: 2-73                                                           --                        (recursive)
│    │    └─ActQuantProxyFromInjector: 3-76                                      --                        (recursive)
├─Sequential: 1-63                                                               --                        (recursive)
│    └─InvertedBlock: 2-74                                                       --                        (recursive)
│    │    └─Sequential: 3-77                                                     --                        (recursive)
├─Sequential: 1-62                                                               --                        (recursive)
│    └─QuantReLU: 2-73                                                           --                        (recursive)
│    │    └─ActQuantProxyFromInjector: 3-76                                      --                        (recursive)
├─Sequential: 1-63                                                               --                        (recursive)
│    └─InvertedBlock: 2-74                                                       --                        (recursive)
│    │    └─Sequential: 3-77                                                     --                        (recursive)
├─Sequential: 1-64                                                               [1, 128, 7, 7]            --
│    └─QuantConv2d: 2-75                                                         [1, 128, 7, 7]            --
│    │    └─ActQuantProxyFromInjector: 3-78                                      [1, 64, 7, 7]             --
│    │    └─WeightQuantProxyFromInjector: 3-79                                   [128, 64, 1, 1]           8,192
│    │    └─ActQuantProxyFromInjector: 3-80                                      [1, 128, 7, 7]            --
│    └─BatchNorm2d: 2-76                                                         [1, 128, 7, 7]            256
│    └─QuantReLU: 2-77                                                           [1, 128, 7, 7]            --
│    │    └─ActQuantProxyFromInjector: 3-81                                      [1, 128, 7, 7]            --
│    │    └─ActQuantProxyFromInjector: 3-82                                      [1, 128, 7, 7]            1
├─TruncAvgPool2d: 1-65                                                           [1, 128, 1, 1]            --
│    └─TruncQuantProxyFromInjector: 2-78                                         [1, 128, 1, 1]            --
│    │    └─TruncIntQuant: 3-83                                                  [1, 128, 1, 1]            --
├─QuantLinear: 1-66                                                              [1, 2]                    2
│    └─ActQuantProxyFromInjector: 2-79                                           [1, 128]                  --
│    └─WeightQuantProxyFromInjector: 2-80                                        [2, 128]                  --
│    │    └─RescalingIntQuant: 3-84                                              [2, 128]                  256
│    └─BiasQuantProxyFromInjector: 2-81                                          [2]                       --
│    │    └─PrescaledRestrictIntQuant: 3-85                                      [2]                       --
│    └─ActQuantProxyFromInjector: 2-82                                           [1, 2]                    --
==================================================================================================================================
Total params: 163,651
Trainable params: 163,651
Non-trainable params: 0
Total mult-adds (M): 0.00
==================================================================================================================================
Input size (MB): 0.15
Forward/backward pass size (MB): 4.06
Params size (MB): 0.01
Estimated Total Size (MB): 4.23
==================================================================================================================================

Loss Function: BCE
Smoke Precision Weight: 0.8
Starting script


***Start Training: 13:38:25


=== EPOCH 0/4 ===
Learning Rate = 0.001

TRAIN Stats
Total Loss |Smoke Loss|Fire Loss |    _______|Accuracy |Precision|Recall   |F1       |
-----------|----------|----------|    Smoke  |0.5453   |0.5348   |0.5399   |0.5374   |
154.66     |48.36     |106.30    |    Fire   |0.4141   |0.3379   |0.8104   |0.4770   |

VAL Stats
Total Loss |Smoke Loss|Fire Loss |    _______|Accuracy |Precision|Recall   |F1       |
-----------|----------|----------|    Smoke  |0.5104   |0.0000   |0.0000   |0.0000   |
85.66      |40.14     |45.52     |    Fire   |0.3620   |0.3028   |0.8534   |0.4470   |

Saving model with new best validation loss: 85.6648
Saving model with best Mean F1: 0.2235

=== EPOCH 1/4 ===
Learning Rate = 0.001

TRAIN Stats
Total Loss |Smoke Loss|Fire Loss |    _______|Accuracy |Precision|Recall   |F1       |
-----------|----------|----------|    Smoke  |0.5047   |0.4853   |0.2109   |0.2940   |
98.61      |44.04     |54.58     |    Fire   |0.6687   |0.0000   |0.0000   |0.0000   |

VAL Stats
Total Loss |Smoke Loss|Fire Loss |    _______|Accuracy |Precision|Recall   |F1       |
-----------|----------|----------|    Smoke  |0.4896   |0.4459   |0.1755   |0.2519   |
80.04      |39.98     |40.06     |    Fire   |0.6927   |0.0000   |0.0000   |0.0000   |

Saving model with new best validation loss: 80.0370

=== EPOCH 2/4 ===
Learning Rate = 0.001

TRAIN Stats
Total Loss |Smoke Loss|Fire Loss |    _______|Accuracy |Precision|Recall   |F1       |
-----------|----------|----------|    Smoke  |0.5359   |0.5231   |0.5783   |0.5493   |
87.96      |42.21     |45.75     |    Fire   |0.5828   |0.3205   |0.2370   |0.2725   |

VAL Stats
Total Loss |Smoke Loss|Fire Loss |    _______|Accuracy |Precision|Recall   |F1       |
-----------|----------|----------|    Smoke  |0.4974   |0.3913   |0.0479   |0.0853   |
80.07      |40.19     |39.88     |    Fire   |0.6901   |0.3636   |0.0345   |0.0630   |


=== EPOCH 3/4 ===
Learning Rate = 0.001

TRAIN Stats
Total Loss |Smoke Loss|Fire Loss |    _______|Accuracy |Precision|Recall   |F1       |
-----------|----------|----------|    Smoke  |0.5312   |0.5327   |0.3387   |0.4141   |
82.28      |40.55     |41.73     |    Fire   |0.6391   |0.3684   |0.1327   |0.1951   |

VAL Stats
Total Loss |Smoke Loss|Fire Loss |    _______|Accuracy |Precision|Recall   |F1       |
-----------|----------|----------|    Smoke  |0.4948   |0.4826   |0.4415   |0.4611   |
81.54      |40.56     |40.98     |    Fire   |0.6927   |0.2500   |0.0086   |0.0167   |

Saving model with best Mean F1: 0.2389

=== EPOCH 4/4 ===
Learning Rate = 0.001

TRAIN Stats
Total Loss |Smoke Loss|Fire Loss |    _______|Accuracy |Precision|Recall   |F1       |
-----------|----------|----------|    Smoke  |0.5469   |0.5462   |0.4345   |0.4840   |
82.65      |40.06     |42.58     |    Fire   |0.6609   |0.4118   |0.0664   |0.1143   |

VAL Stats
Total Loss |Smoke Loss|Fire Loss |    _______|Accuracy |Precision|Recall   |F1       |
-----------|----------|----------|    Smoke  |0.5052   |0.4939   |0.4309   |0.4602   |
83.22      |40.70     |42.52     |    Fire   |0.5938   |0.3507   |0.4052   |0.3760   |

Saving model with best Mean F1: 0.4181
Saving last model
Best F1 Mean at epoch: 4

***Script finished: 13:39:00

Time elapsed: 0:00:34.327294

Loading best F1 Mean model, trained for 4 epochs

Testing with FULL TEST LOADER
{'Accuracy': [0.5052083134651184, 0.59375], 'Precision': [0.49390244483947754, 0.3507462739944458], 'Recall': [0.4308510720729828, 0.4051724076271057], 'F1': [0.46022728085517883, 0.37599998712539673]}

Testing with DFire MINI TRAIN after LOADING F1 Best Mean CHECKPOINT
{'Accuracy': [0.47999998927116394, 0.6399999856948853], 'Precision': [0.7948718070983887, 0.4848484992980957], 'Recall': [0.41333332657814026, 0.4571428596973419], 'F1': [0.5438596606254578, 0.47058823704719543]}

Testing with DFire MINI TEST after LOADING F1 Best Mean CHECKPOINT
{'Accuracy': [0.30000001192092896, 0.5], 'Precision': [0.5454545617103577, 0.30000001192092896], 'Recall': [0.27272728085517883, 0.27272728085517883], 'F1': [0.3636363744735718, 0.2857142984867096]}

###############################################################
            Results of BIPOLAR OUT Model
###############################################################

Testing with FULL TEST LOADER
{'Accuracy': [0.5052083134651184, 0.59375], 'Precision': [0.49390244483947754, 0.3507462739944458], 'Recall': [0.4308510720729828, 0.4051724076271057], 'F1': [0.46022728085517883, 0.37599998712539673]}

Testing with DFire MINI TRAIN after LOADING F1 Best Mean CHECKPOINT
{'Accuracy': [0.47999998927116394, 0.6399999856948853], 'Precision': [0.7948718070983887, 0.4848484992980957], 'Recall': [0.41333332657814026, 0.4571428596973419], 'F1': [0.5438596606254578, 0.47058823704719543]}

Testing with DFire MINI TEST after LOADING F1 Best Mean CHECKPOINT
{'Accuracy': [0.30000001192092896, 0.5], 'Precision': [0.5454545617103577, 0.30000001192092896], 'Recall': [0.27272728085517883, 0.27272728085517883], 'F1': [0.3636363744735718, 0.2857142984867096]}
