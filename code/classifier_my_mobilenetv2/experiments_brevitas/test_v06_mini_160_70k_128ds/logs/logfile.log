BED Classifier.
	One Head.
	Weighted for Precision.
	Brevitas Default.
	Dataset images divided by 255.


Datasets Length
	Train and Val: 128

Load Model: False

Device: cuda
Optimizer:
	Learning Rate: 0.001
	Weight Decay: 0.001
Scheduler:
	Scheduler factor: 0.8
	Scheduler patience: 2
	Scheduler threshold: 0.001
	Scheduler min learning rate: 1e-06

Batch Size: 64
Num Workers: 8
Pin Memory: True
Epochs: 5

IMG DIMS:
	Width: 160
	Height: 160

Brevitas Config:
	Fixed Point: True
	Weights Bit Width: 4
	Big Layers Weights Bit Width: 4
	Bias Bit Width: 4
	Activations Bit Width: 4

Trainable parameters = 68914
Total parameters = 68914

==================================================================================================================================
Layer (type:depth-idx)                                                           Output Shape              Param #
==================================================================================================================================
MobileNetV2_MINI_160                                                             [1, 2]                    --
├─Sequential: 1-1                                                                [1, 64, 10, 10]           60,206
│    └─QuantIdentity: 2-1                                                        [1, 3, 160, 160]          --
│    │    └─ActQuantProxyFromInjector: 3-1                                       [1, 3, 160, 160]          --
│    │    └─ActQuantProxyFromInjector: 3-2                                       [1, 3, 160, 160]          1
├─Sequential: 1-62                                                               --                        (recursive)
│    └─QuantReLU: 2-73                                                           --                        (recursive)
│    │    └─ActQuantProxyFromInjector: 3-76                                      --                        (recursive)
├─Sequential: 1-63                                                               --                        (recursive)
│    └─QuantIdentity: 2-3                                                        --                        (recursive)
│    │    └─ActQuantProxyFromInjector: 3-4                                       --                        (recursive)
│    └─Sequential: 2-4                                                           [1, 32, 80, 80]           --
│    │    └─QuantConv2d: 3-5                                                     [1, 32, 80, 80]           864
│    │    └─BatchNorm2d: 3-6                                                     [1, 32, 80, 80]           64
│    │    └─QuantReLU: 3-7                                                       [1, 32, 80, 80]           1
├─Sequential: 1-62                                                               --                        (recursive)
│    └─QuantReLU: 2-73                                                           --                        (recursive)
│    │    └─ActQuantProxyFromInjector: 3-76                                      --                        (recursive)
├─Sequential: 1-63                                                               --                        (recursive)
│    └─Sequential: 2-6                                                           --                        (recursive)
│    │    └─QuantReLU: 3-9                                                       --                        (recursive)
│    └─InvertedBlock: 2-7                                                        [1, 8, 80, 80]            --
│    │    └─Sequential: 3-10                                                     [1, 8, 80, 80]            626
├─Sequential: 1-62                                                               --                        (recursive)
│    └─QuantReLU: 2-73                                                           --                        (recursive)
│    │    └─ActQuantProxyFromInjector: 3-76                                      --                        (recursive)
├─Sequential: 1-63                                                               --                        (recursive)
│    └─InvertedBlock: 2-11                                                       --                        (recursive)
│    │    └─Sequential: 3-14                                                     --                        (recursive)
├─Sequential: 1-62                                                               --                        (recursive)
│    └─QuantReLU: 2-73                                                           --                        (recursive)
│    │    └─ActQuantProxyFromInjector: 3-76                                      --                        (recursive)
├─Sequential: 1-63                                                               --                        (recursive)
│    └─InvertedBlock: 2-11                                                       --                        (recursive)
│    │    └─Sequential: 3-14                                                     --                        (recursive)
│    └─InvertedBlock: 2-12                                                       [1, 16, 40, 40]           --
│    │    └─Sequential: 3-15                                                     [1, 16, 40, 40]           627
├─Sequential: 1-62                                                               --                        (recursive)
│    └─QuantReLU: 2-73                                                           --                        (recursive)
│    │    └─ActQuantProxyFromInjector: 3-76                                      --                        (recursive)
├─Sequential: 1-63                                                               --                        (recursive)
│    └─InvertedBlock: 2-18                                                       --                        (recursive)
│    │    └─Sequential: 3-21                                                     --                        (recursive)
├─Sequential: 1-62                                                               --                        (recursive)
│    └─QuantReLU: 2-73                                                           --                        (recursive)
│    │    └─ActQuantProxyFromInjector: 3-76                                      --                        (recursive)
├─Sequential: 1-63                                                               --                        (recursive)
│    └─InvertedBlock: 2-18                                                       --                        (recursive)
│    │    └─Sequential: 3-21                                                     --                        (recursive)
├─Sequential: 1-62                                                               --                        (recursive)
│    └─QuantReLU: 2-73                                                           --                        (recursive)
│    │    └─ActQuantProxyFromInjector: 3-76                                      --                        (recursive)
├─Sequential: 1-63                                                               --                        (recursive)
│    └─InvertedBlock: 2-18                                                       --                        (recursive)
│    │    └─Sequential: 3-21                                                     --                        (recursive)
│    └─InvertedBlock: 2-19                                                       [1, 16, 40, 40]           --
│    │    └─Sequential: 3-22                                                     [1, 16, 40, 40]           1,475
├─Sequential: 1-62                                                               --                        (recursive)
│    └─QuantReLU: 2-73                                                           --                        (recursive)
│    │    └─ActQuantProxyFromInjector: 3-76                                      --                        (recursive)
├─Sequential: 1-63                                                               --                        (recursive)
│    └─InvertedBlock: 2-25                                                       --                        (recursive)
│    │    └─Sequential: 3-28                                                     --                        (recursive)
├─Sequential: 1-62                                                               --                        (recursive)
│    └─QuantReLU: 2-73                                                           --                        (recursive)
│    │    └─ActQuantProxyFromInjector: 3-76                                      --                        (recursive)
├─Sequential: 1-63                                                               --                        (recursive)
│    └─InvertedBlock: 2-25                                                       --                        (recursive)
│    │    └─Sequential: 3-28                                                     --                        (recursive)
├─Sequential: 1-62                                                               --                        (recursive)
│    └─QuantReLU: 2-73                                                           --                        (recursive)
│    │    └─ActQuantProxyFromInjector: 3-76                                      --                        (recursive)
├─Sequential: 1-63                                                               --                        (recursive)
│    └─InvertedBlock: 2-25                                                       --                        (recursive)
│    │    └─Sequential: 3-28                                                     --                        (recursive)
│    └─InvertedBlock: 2-26                                                       [1, 24, 20, 20]           --
│    │    └─Sequential: 3-29                                                     [1, 24, 20, 20]           1,747
├─Sequential: 1-62                                                               --                        (recursive)
│    └─QuantReLU: 2-73                                                           --                        (recursive)
│    │    └─ActQuantProxyFromInjector: 3-76                                      --                        (recursive)
├─Sequential: 1-63                                                               --                        (recursive)
│    └─InvertedBlock: 2-32                                                       --                        (recursive)
│    │    └─Sequential: 3-35                                                     --                        (recursive)
├─Sequential: 1-62                                                               --                        (recursive)
│    └─QuantReLU: 2-73                                                           --                        (recursive)
│    │    └─ActQuantProxyFromInjector: 3-76                                      --                        (recursive)
├─Sequential: 1-63                                                               --                        (recursive)
│    └─InvertedBlock: 2-32                                                       --                        (recursive)
│    │    └─Sequential: 3-35                                                     --                        (recursive)
├─Sequential: 1-62                                                               --                        (recursive)
│    └─QuantReLU: 2-73                                                           --                        (recursive)
│    │    └─ActQuantProxyFromInjector: 3-76                                      --                        (recursive)
├─Sequential: 1-63                                                               --                        (recursive)
│    └─InvertedBlock: 2-32                                                       --                        (recursive)
│    │    └─Sequential: 3-35                                                     --                        (recursive)
│    └─InvertedBlock: 2-33                                                       [1, 24, 20, 20]           --
│    │    └─Sequential: 3-36                                                     [1, 24, 20, 20]           2,979
├─Sequential: 1-62                                                               --                        (recursive)
│    └─QuantReLU: 2-73                                                           --                        (recursive)
│    │    └─ActQuantProxyFromInjector: 3-76                                      --                        (recursive)
├─Sequential: 1-63                                                               --                        (recursive)
│    └─InvertedBlock: 2-39                                                       --                        (recursive)
│    │    └─Sequential: 3-42                                                     --                        (recursive)
├─Sequential: 1-62                                                               --                        (recursive)
│    └─QuantReLU: 2-73                                                           --                        (recursive)
│    │    └─ActQuantProxyFromInjector: 3-76                                      --                        (recursive)
├─Sequential: 1-63                                                               --                        (recursive)
│    └─InvertedBlock: 2-39                                                       --                        (recursive)
│    │    └─Sequential: 3-42                                                     --                        (recursive)
├─Sequential: 1-62                                                               --                        (recursive)
│    └─QuantReLU: 2-73                                                           --                        (recursive)
│    │    └─ActQuantProxyFromInjector: 3-76                                      --                        (recursive)
├─Sequential: 1-63                                                               --                        (recursive)
│    └─InvertedBlock: 2-39                                                       --                        (recursive)
│    │    └─Sequential: 3-42                                                     --                        (recursive)
│    └─InvertedBlock: 2-40                                                       [1, 32, 10, 10]           --
│    │    └─Sequential: 3-43                                                     [1, 32, 10, 10]           6,691
├─Sequential: 1-62                                                               --                        (recursive)
│    └─QuantReLU: 2-73                                                           --                        (recursive)
│    │    └─ActQuantProxyFromInjector: 3-76                                      --                        (recursive)
├─Sequential: 1-63                                                               --                        (recursive)
│    └─InvertedBlock: 2-46                                                       --                        (recursive)
│    │    └─Sequential: 3-49                                                     --                        (recursive)
├─Sequential: 1-62                                                               --                        (recursive)
│    └─QuantReLU: 2-73                                                           --                        (recursive)
│    │    └─ActQuantProxyFromInjector: 3-76                                      --                        (recursive)
├─Sequential: 1-63                                                               --                        (recursive)
│    └─InvertedBlock: 2-46                                                       --                        (recursive)
│    │    └─Sequential: 3-49                                                     --                        (recursive)
├─Sequential: 1-62                                                               --                        (recursive)
│    └─QuantReLU: 2-73                                                           --                        (recursive)
│    │    └─ActQuantProxyFromInjector: 3-76                                      --                        (recursive)
├─Sequential: 1-63                                                               --                        (recursive)
│    └─InvertedBlock: 2-46                                                       --                        (recursive)
│    │    └─Sequential: 3-49                                                     --                        (recursive)
│    └─InvertedBlock: 2-47                                                       [1, 32, 10, 10]           --
│    │    └─Sequential: 3-50                                                     [1, 32, 10, 10]           9,923
├─Sequential: 1-62                                                               --                        (recursive)
│    └─QuantReLU: 2-73                                                           --                        (recursive)
│    │    └─ActQuantProxyFromInjector: 3-76                                      --                        (recursive)
├─Sequential: 1-63                                                               --                        (recursive)
│    └─InvertedBlock: 2-53                                                       --                        (recursive)
│    │    └─Sequential: 3-56                                                     --                        (recursive)
├─Sequential: 1-62                                                               --                        (recursive)
│    └─QuantReLU: 2-73                                                           --                        (recursive)
│    │    └─ActQuantProxyFromInjector: 3-76                                      --                        (recursive)
├─Sequential: 1-63                                                               --                        (recursive)
│    └─InvertedBlock: 2-53                                                       --                        (recursive)
│    │    └─Sequential: 3-56                                                     --                        (recursive)
├─Sequential: 1-62                                                               --                        (recursive)
│    └─QuantReLU: 2-73                                                           --                        (recursive)
│    │    └─ActQuantProxyFromInjector: 3-76                                      --                        (recursive)
├─Sequential: 1-63                                                               --                        (recursive)
│    └─InvertedBlock: 2-53                                                       --                        (recursive)
│    │    └─Sequential: 3-56                                                     --                        (recursive)
│    └─InvertedBlock: 2-54                                                       [1, 32, 10, 10]           --
│    │    └─Sequential: 3-57                                                     [1, 32, 10, 10]           9,923
├─Sequential: 1-62                                                               --                        (recursive)
│    └─QuantReLU: 2-73                                                           --                        (recursive)
│    │    └─ActQuantProxyFromInjector: 3-76                                      --                        (recursive)
├─Sequential: 1-63                                                               --                        (recursive)
│    └─InvertedBlock: 2-60                                                       --                        (recursive)
│    │    └─Sequential: 3-63                                                     --                        (recursive)
├─Sequential: 1-62                                                               --                        (recursive)
│    └─QuantReLU: 2-73                                                           --                        (recursive)
│    │    └─ActQuantProxyFromInjector: 3-76                                      --                        (recursive)
├─Sequential: 1-63                                                               --                        (recursive)
│    └─InvertedBlock: 2-60                                                       --                        (recursive)
│    │    └─Sequential: 3-63                                                     --                        (recursive)
├─Sequential: 1-62                                                               --                        (recursive)
│    └─QuantReLU: 2-73                                                           --                        (recursive)
│    │    └─ActQuantProxyFromInjector: 3-76                                      --                        (recursive)
├─Sequential: 1-63                                                               --                        (recursive)
│    └─InvertedBlock: 2-60                                                       --                        (recursive)
│    │    └─Sequential: 3-63                                                     --                        (recursive)
│    └─InvertedBlock: 2-61                                                       [1, 64, 10, 10]           --
│    │    └─Sequential: 3-64                                                     [1, 64, 10, 10]           7,107
├─Sequential: 1-62                                                               --                        (recursive)
│    └─QuantReLU: 2-73                                                           --                        (recursive)
│    │    └─ActQuantProxyFromInjector: 3-76                                      --                        (recursive)
├─Sequential: 1-63                                                               --                        (recursive)
│    └─InvertedBlock: 2-67                                                       --                        (recursive)
│    │    └─Sequential: 3-70                                                     --                        (recursive)
├─Sequential: 1-62                                                               --                        (recursive)
│    └─QuantReLU: 2-73                                                           --                        (recursive)
│    │    └─ActQuantProxyFromInjector: 3-76                                      --                        (recursive)
├─Sequential: 1-63                                                               --                        (recursive)
│    └─InvertedBlock: 2-67                                                       --                        (recursive)
│    │    └─Sequential: 3-70                                                     --                        (recursive)
├─Sequential: 1-62                                                               --                        (recursive)
│    └─QuantReLU: 2-73                                                           --                        (recursive)
│    │    └─ActQuantProxyFromInjector: 3-76                                      --                        (recursive)
├─Sequential: 1-63                                                               --                        (recursive)
│    └─InvertedBlock: 2-67                                                       --                        (recursive)
│    │    └─Sequential: 3-70                                                     --                        (recursive)
│    └─InvertedBlock: 2-68                                                       [1, 64, 10, 10]           --
│    │    └─Sequential: 3-71                                                     [1, 64, 10, 10]           18,179
├─Sequential: 1-62                                                               --                        (recursive)
│    └─QuantReLU: 2-73                                                           --                        (recursive)
│    │    └─ActQuantProxyFromInjector: 3-76                                      --                        (recursive)
├─Sequential: 1-63                                                               --                        (recursive)
│    └─InvertedBlock: 2-74                                                       --                        (recursive)
│    │    └─Sequential: 3-77                                                     --                        (recursive)
├─Sequential: 1-62                                                               --                        (recursive)
│    └─QuantReLU: 2-73                                                           --                        (recursive)
│    │    └─ActQuantProxyFromInjector: 3-76                                      --                        (recursive)
├─Sequential: 1-63                                                               --                        (recursive)
│    └─InvertedBlock: 2-74                                                       --                        (recursive)
│    │    └─Sequential: 3-77                                                     --                        (recursive)
├─Sequential: 1-62                                                               --                        (recursive)
│    └─QuantReLU: 2-73                                                           --                        (recursive)
│    │    └─ActQuantProxyFromInjector: 3-76                                      --                        (recursive)
├─Sequential: 1-63                                                               --                        (recursive)
│    └─InvertedBlock: 2-74                                                       --                        (recursive)
│    │    └─Sequential: 3-77                                                     --                        (recursive)
├─Sequential: 1-64                                                               [1, 128, 10, 10]          --
│    └─QuantConv2d: 2-75                                                         [1, 128, 10, 10]          --
│    │    └─ActQuantProxyFromInjector: 3-78                                      [1, 64, 10, 10]           --
│    │    └─WeightQuantProxyFromInjector: 3-79                                   [128, 64, 1, 1]           8,192
│    │    └─ActQuantProxyFromInjector: 3-80                                      [1, 128, 10, 10]          --
│    └─BatchNorm2d: 2-76                                                         [1, 128, 10, 10]          256
│    └─QuantReLU: 2-77                                                           [1, 128, 10, 10]          --
│    │    └─ActQuantProxyFromInjector: 3-81                                      [1, 128, 10, 10]          --
│    │    └─ActQuantProxyFromInjector: 3-82                                      [1, 128, 10, 10]          1
├─TruncAvgPool2d: 1-65                                                           [1, 128, 1, 1]            --
│    └─TruncQuantProxyFromInjector: 2-78                                         [1, 128, 1, 1]            --
│    │    └─TruncIntQuant: 3-83                                                  [1, 128, 1, 1]            --
├─QuantLinear: 1-66                                                              [1, 2]                    2
│    └─ActQuantProxyFromInjector: 2-79                                           [1, 128]                  --
│    └─WeightQuantProxyFromInjector: 2-80                                        [2, 128]                  --
│    │    └─RescalingIntQuant: 3-84                                              [2, 128]                  256
│    └─BiasQuantProxyFromInjector: 2-81                                          [2]                       --
│    │    └─PrescaledRestrictIntQuant: 3-85                                      [2]                       --
│    └─ActQuantProxyFromInjector: 2-82                                           [1, 2]                    --
==================================================================================================================================
Total params: 163,651
Trainable params: 163,651
Non-trainable params: 0
Total mult-adds (M): 0.00
==================================================================================================================================
Input size (MB): 0.31
Forward/backward pass size (MB): 8.29
Params size (MB): 0.01
Estimated Total Size (MB): 8.62
==================================================================================================================================

Loss Function: BCE
Smoke Precision Weight: 0.8
Starting script


***Start Training: 22:08:42


=== EPOCH 0/4 ===
Learning Rate = 0.001

TRAIN Stats
Total Loss |Smoke Loss|Fire Loss |    _______|Accuracy |Precision|Recall   |F1       |
-----------|----------|----------|    Smoke  |0.5422   |0.5394   |0.4377   |0.4832   |
81.02      |40.98     |40.03     |    Fire   |0.6516   |0.4565   |0.2986   |0.3610   |

VAL Stats
Total Loss |Smoke Loss|Fire Loss |    _______|Accuracy |Precision|Recall   |F1       |
-----------|----------|----------|    Smoke  |0.4974   |0.4242   |0.0745   |0.1267   |
85.40      |39.80     |45.60     |    Fire   |0.3750   |0.3098   |0.8707   |0.4570   |

Saving model with new best validation loss: 85.4045
Saving model with best Mean F1: 0.2919

=== EPOCH 1/4 ===
Learning Rate = 0.001

TRAIN Stats
Total Loss |Smoke Loss|Fire Loss |    _______|Accuracy |Precision|Recall   |F1       |
-----------|----------|----------|    Smoke  |0.6016   |0.6272   |0.4569   |0.5287   |
72.08      |37.67     |34.40     |    Fire   |0.7219   |0.5922   |0.5024   |0.5436   |

VAL Stats
Total Loss |Smoke Loss|Fire Loss |    _______|Accuracy |Precision|Recall   |F1       |
-----------|----------|----------|    Smoke  |0.4896   |0.4896   |1.0000   |0.6573   |
87.13      |47.42     |39.71     |    Fire   |0.6979   |0.0000   |0.0000   |0.0000   |

Saving model with best Mean F1: 0.3287

=== EPOCH 2/4 ===
Learning Rate = 0.001

TRAIN Stats
Total Loss |Smoke Loss|Fire Loss |    _______|Accuracy |Precision|Recall   |F1       |
-----------|----------|----------|    Smoke  |0.5719   |0.5714   |0.4984   |0.5324   |
70.75      |39.43     |31.32     |    Fire   |0.7406   |0.6257   |0.5308   |0.5744   |

VAL Stats
Total Loss |Smoke Loss|Fire Loss |    _______|Accuracy |Precision|Recall   |F1       |
-----------|----------|----------|    Smoke  |0.4818   |0.4830   |0.8298   |0.6106   |
95.67      |41.86     |53.81     |    Fire   |0.3073   |0.2928   |0.9138   |0.4435   |

Saving model with best Mean F1: 0.5270

=== EPOCH 3/4 ===
Learning Rate = 0.001

TRAIN Stats
Total Loss |Smoke Loss|Fire Loss |    _______|Accuracy |Precision|Recall   |F1       |
-----------|----------|----------|    Smoke  |0.6250   |0.6443   |0.5208   |0.5760   |
68.88      |36.81     |32.07     |    Fire   |0.7688   |0.6909   |0.5403   |0.6064   |

VAL Stats
Total Loss |Smoke Loss|Fire Loss |    _______|Accuracy |Precision|Recall   |F1       |
-----------|----------|----------|    Smoke  |0.5078   |0.4986   |0.9734   |0.6595   |
118.24     |51.18     |67.05     |    Fire   |0.3568   |0.3196   |1.0000   |0.4843   |

Saving model with best Mean F1: 0.5719

=== EPOCH 4/4 ===
Learning Rate = 0.0008

TRAIN Stats
Total Loss |Smoke Loss|Fire Loss |    _______|Accuracy |Precision|Recall   |F1       |
-----------|----------|----------|    Smoke  |0.6438   |0.6680   |0.5399   |0.5972   |
67.95      |36.37     |31.58     |    Fire   |0.7359   |0.6207   |0.5118   |0.5610   |

VAL Stats
Total Loss |Smoke Loss|Fire Loss |    _______|Accuracy |Precision|Recall   |F1       |
-----------|----------|----------|    Smoke  |0.5156   |0.5027   |0.9734   |0.6630   |
99.82      |52.13     |47.69     |    Fire   |0.5182   |0.3772   |0.9138   |0.5340   |

Saving model with best Mean F1: 0.5985
Saving last model

***Script finished: 22:09:25

Time elapsed: 0:00:42.496820

Testing with FULL TEST LOADER
{'Accuracy': [0.515625, 0.5182291865348816], 'Precision': [0.5027472376823425, 0.3772242069244385], 'Recall': [0.9734042286872864, 0.9137930870056152], 'F1': [0.6630434989929199, 0.5340050458908081]}

Testing with DFire MINI TRAIN after LOADING F1 Best Mean CHECKPOINT
{'Accuracy': [0.75, 0.5799999833106995], 'Precision': [0.7551020383834839, 0.45205479860305786], 'Recall': [0.9866666793823242, 0.9428571462631226], 'F1': [0.8554913401603699, 0.6111111044883728]}

Testing with DFire MINI TEST after LOADING F1 Best Mean CHECKPOINT
{'Accuracy': [0.7333333492279053, 0.4333333373069763], 'Precision': [0.7692307829856873, 0.38461539149284363], 'Recall': [0.9090909361839294, 0.9090909361839294], 'F1': [0.8333333134651184, 0.5405405163764954]}
