BED Classifier.
	One Head.
	Weighted for Precision.
	Brevitas Default.
	Dataset images divided by 255.

Training Brevitas Model = True

Datasets Length
	Train and Val: 128

Load Model: False

Device: cuda
Optimizer:
	Learning Rate: 0.001
	Weight Decay: 0.001
Scheduler:
	Scheduler factor: 0.8
	Scheduler patience: 2
	Scheduler threshold: 0.001
	Scheduler min learning rate: 1e-06

Batch Size: 64
Num Workers: 8
Pin Memory: True
Epochs: 3

IMG DIMS:
	Width: 230
	Height: 230

Brevitas Config:
	Fixed Point: True
	Weights Bit Width: 4
	Big Layers Weights Bit Width: 4
	Bias Bit Width: 4
	Activations Bit Width: 4

Trainable parameters = 60397
Total parameters = 60397

=============================================================================================================================
Layer (type:depth-idx)                                                      Output Shape              Param #
=============================================================================================================================
BED_AIMET_FPGA_MANUAL_OLD                                                   [1, 2]                    --
├─Sequential: 1-1                                                           [1, 64, 20, 20]           58,217
│    └─QuantIdentity: 2-1                                                   [1, 3, 230, 230]          --
│    │    └─ActQuantProxyFromInjector: 3-1                                  [1, 3, 230, 230]          --
│    │    └─ActQuantProxyFromInjector: 3-2                                  [1, 3, 230, 230]          1
├─Sequential: 1-36                                                          --                        (recursive)
│    └─QuantReLU: 2-51                                                      --                        (recursive)
│    │    └─ActQuantProxyFromInjector: 3-88                                 --                        (recursive)
├─Sequential: 1-37                                                          --                        (recursive)
│    └─QuantIdentity: 2-3                                                   --                        (recursive)
│    │    └─ActQuantProxyFromInjector: 3-4                                  --                        (recursive)
│    └─Sequential: 2-4                                                      [1, 12, 228, 228]         --
│    │    └─QuantConv2d: 3-5                                                [1, 12, 228, 228]         324
│    │    └─BatchNorm2d: 3-6                                                [1, 12, 228, 228]         24
│    │    └─QuantReLU: 3-7                                                  [1, 12, 228, 228]         1
├─Sequential: 1-36                                                          --                        (recursive)
│    └─QuantReLU: 2-51                                                      --                        (recursive)
│    │    └─ActQuantProxyFromInjector: 3-88                                 --                        (recursive)
├─Sequential: 1-37                                                          --                        (recursive)
│    └─Sequential: 2-6                                                      --                        (recursive)
│    │    └─QuantReLU: 3-9                                                  --                        (recursive)
│    └─MaxPool2d: 2-7                                                       [1, 12, 114, 114]         --
│    └─Sequential: 2-8                                                      [1, 16, 112, 112]         1,185
│    │    └─QuantConv2d: 3-10                                               [1, 24, 112, 114]         864
│    │    └─BatchNorm2d: 3-11                                               [1, 24, 112, 114]         48
│    │    └─QuantIdentity: 3-12                                             [1, 24, 112, 114]         1
├─Sequential: 1-36                                                          --                        (recursive)
│    └─QuantReLU: 2-51                                                      --                        (recursive)
│    │    └─ActQuantProxyFromInjector: 3-88                                 --                        (recursive)
├─Sequential: 1-37                                                          --                        (recursive)
│    └─Sequential: 2-12                                                     --                        (recursive)
│    │    └─QuantIdentity: 3-14                                             --                        (recursive)
│    │    └─QuantConv2d: 3-15                                               [1, 16, 112, 112]         1,152
│    │    └─BatchNorm2d: 3-16                                               [1, 16, 112, 112]         32
│    │    └─QuantReLU: 3-17                                                 [1, 16, 112, 112]         1
├─Sequential: 1-36                                                          --                        (recursive)
│    └─QuantReLU: 2-51                                                      --                        (recursive)
│    │    └─ActQuantProxyFromInjector: 3-88                                 --                        (recursive)
├─Sequential: 1-37                                                          --                        (recursive)
│    └─Sequential: 2-12                                                     --                        (recursive)
│    │    └─QuantReLU: 3-19                                                 --                        (recursive)
│    └─MaxPool2d: 2-13                                                      [1, 16, 56, 56]           --
│    └─Sequential: 2-14                                                     [1, 16, 56, 56]           --
│    │    └─QuantConv2d: 3-20                                               [1, 16, 56, 56]           256
│    │    └─BatchNorm2d: 3-21                                               [1, 16, 56, 56]           32
│    │    └─QuantReLU: 3-22                                                 [1, 16, 56, 56]           1
├─Sequential: 1-36                                                          --                        (recursive)
│    └─QuantReLU: 2-51                                                      --                        (recursive)
│    │    └─ActQuantProxyFromInjector: 3-88                                 --                        (recursive)
├─Sequential: 1-37                                                          --                        (recursive)
│    └─Sequential: 2-16                                                     --                        (recursive)
│    │    └─QuantReLU: 3-24                                                 --                        (recursive)
│    └─Sequential: 2-17                                                     [1, 32, 54, 54]           1,601
│    │    └─QuantConv2d: 3-25                                               [1, 16, 54, 56]           768
│    │    └─BatchNorm2d: 3-26                                               [1, 16, 54, 56]           32
│    │    └─QuantIdentity: 3-27                                             [1, 16, 54, 56]           1
├─Sequential: 1-36                                                          --                        (recursive)
│    └─QuantReLU: 2-51                                                      --                        (recursive)
│    │    └─ActQuantProxyFromInjector: 3-88                                 --                        (recursive)
├─Sequential: 1-37                                                          --                        (recursive)
│    └─Sequential: 2-21                                                     --                        (recursive)
│    │    └─QuantIdentity: 3-29                                             --                        (recursive)
│    │    └─QuantConv2d: 3-30                                               [1, 32, 54, 54]           1,536
│    │    └─BatchNorm2d: 3-31                                               [1, 32, 54, 54]           64
│    │    └─QuantReLU: 3-32                                                 [1, 32, 54, 54]           1
├─Sequential: 1-36                                                          --                        (recursive)
│    └─QuantReLU: 2-51                                                      --                        (recursive)
│    │    └─ActQuantProxyFromInjector: 3-88                                 --                        (recursive)
├─Sequential: 1-37                                                          --                        (recursive)
│    └─Sequential: 2-21                                                     --                        (recursive)
│    │    └─QuantReLU: 3-34                                                 --                        (recursive)
│    └─Sequential: 2-22                                                     [1, 32, 54, 54]           --
│    │    └─QuantConv2d: 3-35                                               [1, 32, 54, 54]           1,024
│    │    └─BatchNorm2d: 3-36                                               [1, 32, 54, 54]           64
│    │    └─QuantReLU: 3-37                                                 [1, 32, 54, 54]           1
├─Sequential: 1-36                                                          --                        (recursive)
│    └─QuantReLU: 2-51                                                      --                        (recursive)
│    │    └─ActQuantProxyFromInjector: 3-88                                 --                        (recursive)
├─Sequential: 1-37                                                          --                        (recursive)
│    └─Sequential: 2-24                                                     --                        (recursive)
│    │    └─QuantReLU: 3-39                                                 --                        (recursive)
│    └─Sequential: 2-25                                                     [1, 64, 52, 52]           8,193
│    │    └─QuantConv2d: 3-40                                               [1, 42, 52, 54]           4,032
│    │    └─BatchNorm2d: 3-41                                               [1, 42, 52, 54]           84
│    │    └─QuantIdentity: 3-42                                             [1, 42, 52, 54]           1
├─Sequential: 1-36                                                          --                        (recursive)
│    └─QuantReLU: 2-51                                                      --                        (recursive)
│    │    └─ActQuantProxyFromInjector: 3-88                                 --                        (recursive)
├─Sequential: 1-37                                                          --                        (recursive)
│    └─Sequential: 2-29                                                     --                        (recursive)
│    │    └─QuantIdentity: 3-44                                             --                        (recursive)
│    │    └─QuantConv2d: 3-45                                               [1, 64, 52, 52]           8,064
│    │    └─BatchNorm2d: 3-46                                               [1, 64, 52, 52]           128
│    │    └─QuantReLU: 3-47                                                 [1, 64, 52, 52]           1
├─Sequential: 1-36                                                          --                        (recursive)
│    └─QuantReLU: 2-51                                                      --                        (recursive)
│    │    └─ActQuantProxyFromInjector: 3-88                                 --                        (recursive)
├─Sequential: 1-37                                                          --                        (recursive)
│    └─Sequential: 2-29                                                     --                        (recursive)
│    │    └─QuantReLU: 3-49                                                 --                        (recursive)
│    └─MaxPool2d: 2-30                                                      [1, 64, 26, 26]           --
│    └─Sequential: 2-31                                                     [1, 30, 26, 26]           --
│    │    └─QuantConv2d: 3-50                                               [1, 30, 26, 26]           1,920
│    │    └─BatchNorm2d: 3-51                                               [1, 30, 26, 26]           60
│    │    └─QuantReLU: 3-52                                                 [1, 30, 26, 26]           1
├─Sequential: 1-36                                                          --                        (recursive)
│    └─QuantReLU: 2-51                                                      --                        (recursive)
│    │    └─ActQuantProxyFromInjector: 3-88                                 --                        (recursive)
├─Sequential: 1-37                                                          --                        (recursive)
│    └─Sequential: 2-33                                                     --                        (recursive)
│    │    └─QuantReLU: 3-54                                                 --                        (recursive)
│    └─Sequential: 2-34                                                     [1, 60, 24, 24]           --
│    │    └─QuantConv2d: 3-55                                               [1, 60, 24, 24]           16,200
│    │    └─BatchNorm2d: 3-56                                               [1, 60, 24, 24]           120
│    │    └─QuantReLU: 3-57                                                 [1, 60, 24, 24]           1
├─Sequential: 1-36                                                          --                        (recursive)
│    └─QuantReLU: 2-51                                                      --                        (recursive)
│    │    └─ActQuantProxyFromInjector: 3-88                                 --                        (recursive)
├─Sequential: 1-37                                                          --                        (recursive)
│    └─Sequential: 2-36                                                     --                        (recursive)
│    │    └─QuantReLU: 3-59                                                 --                        (recursive)
│    └─Sequential: 2-37                                                     [1, 32, 24, 24]           --
│    │    └─QuantConv2d: 3-60                                               [1, 32, 24, 24]           1,920
│    │    └─BatchNorm2d: 3-61                                               [1, 32, 24, 24]           64
│    │    └─QuantReLU: 3-62                                                 [1, 32, 24, 24]           1
├─Sequential: 1-36                                                          --                        (recursive)
│    └─QuantReLU: 2-51                                                      --                        (recursive)
│    │    └─ActQuantProxyFromInjector: 3-88                                 --                        (recursive)
├─Sequential: 1-37                                                          --                        (recursive)
│    └─Sequential: 2-39                                                     --                        (recursive)
│    │    └─QuantReLU: 3-64                                                 --                        (recursive)
│    └─Sequential: 2-40                                                     [1, 58, 22, 22]           7,425
│    │    └─QuantConv2d: 3-65                                               [1, 42, 22, 24]           4,032
│    │    └─BatchNorm2d: 3-66                                               [1, 42, 22, 24]           84
│    │    └─QuantIdentity: 3-67                                             [1, 42, 22, 24]           1
├─Sequential: 1-36                                                          --                        (recursive)
│    └─QuantReLU: 2-51                                                      --                        (recursive)
│    │    └─ActQuantProxyFromInjector: 3-88                                 --                        (recursive)
├─Sequential: 1-37                                                          --                        (recursive)
│    └─Sequential: 2-44                                                     --                        (recursive)
│    │    └─QuantIdentity: 3-69                                             --                        (recursive)
│    │    └─QuantConv2d: 3-70                                               [1, 58, 22, 22]           7,308
│    │    └─BatchNorm2d: 3-71                                               [1, 58, 22, 22]           116
│    │    └─QuantReLU: 3-72                                                 [1, 58, 22, 22]           1
├─Sequential: 1-36                                                          --                        (recursive)
│    └─QuantReLU: 2-51                                                      --                        (recursive)
│    │    └─ActQuantProxyFromInjector: 3-88                                 --                        (recursive)
├─Sequential: 1-37                                                          --                        (recursive)
│    └─Sequential: 2-44                                                     --                        (recursive)
│    │    └─QuantReLU: 3-74                                                 --                        (recursive)
│    └─Sequential: 2-45                                                     [1, 32, 22, 22]           --
│    │    └─QuantConv2d: 3-75                                               [1, 32, 22, 22]           1,856
│    │    └─BatchNorm2d: 3-76                                               [1, 32, 22, 22]           64
│    │    └─QuantReLU: 3-77                                                 [1, 32, 22, 22]           1
├─Sequential: 1-36                                                          --                        (recursive)
│    └─QuantReLU: 2-51                                                      --                        (recursive)
│    │    └─ActQuantProxyFromInjector: 3-88                                 --                        (recursive)
├─Sequential: 1-37                                                          --                        (recursive)
│    └─Sequential: 2-47                                                     --                        (recursive)
│    │    └─QuantReLU: 3-79                                                 --                        (recursive)
│    └─Sequential: 2-48                                                     [1, 64, 20, 20]           3,969
│    │    └─QuantConv2d: 3-80                                               [1, 20, 20, 22]           1,920
│    │    └─BatchNorm2d: 3-81                                               [1, 20, 20, 22]           40
│    │    └─QuantIdentity: 3-82                                             [1, 20, 20, 22]           1
├─Sequential: 1-36                                                          --                        (recursive)
│    └─QuantReLU: 2-51                                                      --                        (recursive)
│    │    └─ActQuantProxyFromInjector: 3-88                                 --                        (recursive)
├─Sequential: 1-37                                                          --                        (recursive)
│    └─Sequential: 2-52                                                     --                        (recursive)
│    │    └─QuantIdentity: 3-84                                             --                        (recursive)
│    │    └─QuantConv2d: 3-85                                               [1, 64, 20, 20]           3,840
│    │    └─BatchNorm2d: 3-86                                               [1, 64, 20, 20]           128
│    │    └─QuantReLU: 3-87                                                 [1, 64, 20, 20]           1
├─Sequential: 1-36                                                          --                        (recursive)
│    └─QuantReLU: 2-51                                                      --                        (recursive)
│    │    └─ActQuantProxyFromInjector: 3-88                                 --                        (recursive)
├─Sequential: 1-37                                                          --                        (recursive)
│    └─Sequential: 2-52                                                     --                        (recursive)
│    │    └─QuantReLU: 3-89                                                 --                        (recursive)
├─TruncAvgPool2d: 1-38                                                      [1, 64, 1, 1]             --
│    └─TruncQuantProxyFromInjector: 2-53                                    [1, 64, 1, 1]             --
│    │    └─TruncIntQuant: 3-90                                             [1, 64, 1, 1]             --
├─Sequential: 1-39                                                          [1, 2]                    --
│    └─QuantLinear: 2-54                                                    [1, 32]                   --
│    │    └─ActQuantProxyFromInjector: 3-91                                 [1, 64]                   --
│    │    └─WeightQuantProxyFromInjector: 3-92                              [32, 64]                  2,048
│    │    └─ActQuantProxyFromInjector: 3-93                                 [1, 32]                   --
│    └─BatchNorm1d: 2-55                                                    [1, 32]                   64
│    └─QuantReLU: 2-56                                                      [1, 32]                   --
│    │    └─ActQuantProxyFromInjector: 3-94                                 [1, 32]                   --
│    │    └─ActQuantProxyFromInjector: 3-95                                 [1, 32]                   1
│    └─QuantLinear: 2-57                                                    [1, 2]                    --
│    │    └─ActQuantProxyFromInjector: 3-96                                 [1, 32]                   --
│    │    └─WeightQuantProxyFromInjector: 3-97                              [2, 32]                   64
│    │    └─ActQuantProxyFromInjector: 3-98                                 [1, 2]                    --
│    └─TensorNorm: 2-58                                                     [1, 2]                    2
=============================================================================================================================
Total params: 140,987
Trainable params: 140,987
Non-trainable params: 0
Total mult-adds (M): 0.00
=============================================================================================================================
Input size (MB): 0.63
Forward/backward pass size (MB): 15.04
Params size (MB): 0.01
Estimated Total Size (MB): 15.68
=============================================================================================================================

Loss Function: BCE
Smoke Precision Weight: 0.8
Starting script


***Start Training: 10:20:38


=== EPOCH 0/2 ===
Learning Rate = 0.001

TRAIN Stats
Total Loss |Smoke Loss|Fire Loss |    _______|Accuracy |Precision|Recall   |F1       |
-----------|----------|----------|    Smoke  |0.5813   |0.5558   |0.7157   |0.6257   |
80.43      |42.87     |37.57     |    Fire   |0.7031   |0.5393   |0.6825   |0.6025   |

VAL Stats
Total Loss |Smoke Loss|Fire Loss |    _______|Accuracy |Precision|Recall   |F1       |
-----------|----------|----------|    Smoke  |0.5104   |0.0000   |0.0000   |0.0000   |
78.63      |39.55     |39.08     |    Fire   |0.6979   |0.0000   |0.0000   |0.0000   |

Saving model with new best validation loss: 78.6301

=== EPOCH 1/2 ===
Learning Rate = 0.001

TRAIN Stats
Total Loss |Smoke Loss|Fire Loss |    _______|Accuracy |Precision|Recall   |F1       |
-----------|----------|----------|    Smoke  |0.6375   |0.5967   |0.7987   |0.6831   |
69.10      |36.60     |32.50     |    Fire   |0.7891   |0.6583   |0.7488   |0.7007   |

VAL Stats
Total Loss |Smoke Loss|Fire Loss |    _______|Accuracy |Precision|Recall   |F1       |
-----------|----------|----------|    Smoke  |0.4896   |0.4896   |1.0000   |0.6573   |
97.00      |49.31     |47.69     |    Fire   |0.3776   |0.3258   |0.9914   |0.4904   |

Saving model with best Mean F1: 0.5739

=== EPOCH 2/2 ===
Learning Rate = 0.001

TRAIN Stats
Total Loss |Smoke Loss|Fire Loss |    _______|Accuracy |Precision|Recall   |F1       |
-----------|----------|----------|    Smoke  |0.6641   |0.6346   |0.7380   |0.6824   |
66.50      |36.01     |30.49     |    Fire   |0.8188   |0.7111   |0.7583   |0.7339   |

VAL Stats
Total Loss |Smoke Loss|Fire Loss |    _______|Accuracy |Precision|Recall   |F1       |
-----------|----------|----------|    Smoke  |0.4922   |0.4909   |1.0000   |0.6585   |
99.11      |55.66     |43.45     |    Fire   |0.6146   |0.4333   |0.8966   |0.5843   |

Saving model with best Mean F1: 0.6214
Saving last model

***Script finished: 10:21:12

Time elapsed: 0:00:33.410930

Testing with FULL TEST LOADER
{'Accuracy': [0.4921875, 0.6145833134651184], 'Precision': [0.4908616244792938, 0.4333333373069763], 'Recall': [1.0, 0.8965517282485962], 'F1': [0.6584938764572144, 0.584269642829895]}

Testing with DFire MINI TRAIN after LOADING F1 Best Mean CHECKPOINT
{'Accuracy': [0.7599999904632568, 0.6200000047683716], 'Precision': [0.7575757503509521, 0.4769230782985687], 'Recall': [1.0, 0.8857142925262451], 'F1': [0.8620689511299133, 0.6200000047683716]}

Testing with DFire MINI TEST after LOADING F1 Best Mean CHECKPOINT
{'Accuracy': [0.7333333492279053, 0.6666666865348816], 'Precision': [0.7333333492279053, 0.5263158082962036], 'Recall': [1.0, 0.9090909361839294], 'F1': [0.8461538553237915, 0.6666666865348816]}
