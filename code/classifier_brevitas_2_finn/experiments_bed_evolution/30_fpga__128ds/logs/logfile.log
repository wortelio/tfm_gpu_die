BED_FPGA.
	One Head.
	Weighted for Precision.
	Dataset images divided by 255.

Training Brevitas Model = False

Datasets Length
	Train and Val: 128

Load Model: False

Device: cuda
Optimizer:
	Learning Rate: 0.001
	Weight Decay: 0.001
Scheduler:
	Scheduler factor: 0.8
	Scheduler patience: 2
	Scheduler threshold: 0.001
	Scheduler min learning rate: 1e-06

Batch Size: 64
Num Workers: 8
Pin Memory: True
Epochs: 5

IMG DIMS:
	Width: 230
	Height: 230

Brevitas Config:
	Fixed Point: True
	Weights Bit Width: 4
	Big Layers Weights Bit Width: 2
	Bias Bit Width: 4
	Activations Bit Width: 4

********* Datasets Length *********
Train Dataset Length: 640
Test Dataset Length: 384

Trainable parameters = 60090
Total parameters = 60090

==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
BED_CLASSIFIER_FPGA                      [1, 2]                    --
├─Sequential: 1-1                        [1, 2]                    --
│    └─Conv2d: 2-1                       [1, 12, 228, 228]         324
│    └─BatchNorm2d: 2-2                  [1, 12, 228, 228]         24
│    └─ReLU: 2-3                         [1, 12, 228, 228]         --
│    └─MaxPool2d: 2-4                    [1, 12, 114, 114]         --
│    └─Sequential: 2-5                   [1, 16, 112, 112]         --
│    │    └─Conv2d: 3-1                  [1, 24, 112, 114]         864
│    │    └─Conv2d: 3-2                  [1, 16, 112, 112]         1,152
│    └─BatchNorm2d: 2-6                  [1, 16, 112, 112]         32
│    └─ReLU: 2-7                         [1, 16, 112, 112]         --
│    └─MaxPool2d: 2-8                    [1, 16, 56, 56]           --
│    └─Conv2d: 2-9                       [1, 16, 56, 56]           256
│    └─BatchNorm2d: 2-10                 [1, 16, 56, 56]           32
│    └─ReLU: 2-11                        [1, 16, 56, 56]           --
│    └─Sequential: 2-12                  [1, 32, 54, 54]           --
│    │    └─Conv2d: 3-3                  [1, 16, 54, 56]           768
│    │    └─Conv2d: 3-4                  [1, 32, 54, 54]           1,536
│    └─BatchNorm2d: 2-13                 [1, 32, 54, 54]           64
│    └─ReLU: 2-14                        [1, 32, 54, 54]           --
│    └─Conv2d: 2-15                      [1, 32, 54, 54]           1,024
│    └─BatchNorm2d: 2-16                 [1, 32, 54, 54]           64
│    └─ReLU: 2-17                        [1, 32, 54, 54]           --
│    └─Sequential: 2-18                  [1, 64, 52, 52]           --
│    │    └─Conv2d: 3-5                  [1, 42, 52, 54]           4,032
│    │    └─Conv2d: 3-6                  [1, 64, 52, 52]           8,064
│    └─BatchNorm2d: 2-19                 [1, 64, 52, 52]           128
│    └─ReLU: 2-20                        [1, 64, 52, 52]           --
│    └─MaxPool2d: 2-21                   [1, 64, 26, 26]           --
│    └─Conv2d: 2-22                      [1, 30, 26, 26]           1,920
│    └─BatchNorm2d: 2-23                 [1, 30, 26, 26]           60
│    └─ReLU: 2-24                        [1, 30, 26, 26]           --
│    └─Conv2d: 2-25                      [1, 60, 24, 24]           16,200
│    └─BatchNorm2d: 2-26                 [1, 60, 24, 24]           120
│    └─ReLU: 2-27                        [1, 60, 24, 24]           --
│    └─Conv2d: 2-28                      [1, 32, 24, 24]           1,920
│    └─BatchNorm2d: 2-29                 [1, 32, 24, 24]           64
│    └─ReLU: 2-30                        [1, 32, 24, 24]           --
│    └─Sequential: 2-31                  [1, 58, 22, 22]           --
│    │    └─Conv2d: 3-7                  [1, 42, 22, 24]           4,032
│    │    └─Conv2d: 3-8                  [1, 58, 22, 22]           7,308
│    └─BatchNorm2d: 2-32                 [1, 58, 22, 22]           116
│    └─ReLU: 2-33                        [1, 58, 22, 22]           --
│    └─Conv2d: 2-34                      [1, 32, 22, 22]           1,856
│    └─BatchNorm2d: 2-35                 [1, 32, 22, 22]           64
│    └─ReLU: 2-36                        [1, 32, 22, 22]           --
│    └─Sequential: 2-37                  [1, 64, 20, 20]           --
│    │    └─Conv2d: 3-9                  [1, 20, 20, 22]           1,920
│    │    └─Conv2d: 3-10                 [1, 64, 20, 20]           3,840
│    └─BatchNorm2d: 2-38                 [1, 64, 20, 20]           128
│    └─ReLU: 2-39                        [1, 64, 20, 20]           --
│    └─AdaptiveAvgPool2d: 2-40           [1, 64, 1, 1]             --
│    └─Flatten: 2-41                     [1, 64]                   --
│    └─Linear: 2-42                      [1, 32]                   2,048
│    └─BatchNorm1d: 2-43                 [1, 32]                   64
│    └─ReLU: 2-44                        [1, 32]                   --
│    └─Linear: 2-45                      [1, 2]                    66
==========================================================================================
Total params: 60,090
Trainable params: 60,090
Non-trainable params: 0
Total mult-adds (M): 106.73
==========================================================================================
Input size (MB): 0.63
Forward/backward pass size (MB): 26.06
Params size (MB): 0.24
Estimated Total Size (MB): 26.93
==========================================================================================

Loss Function: BCE
Smoke Precision Weight: 0.8
Starting script


***Start Training: 03:28:57


=== EPOCH 0/4 ===
Learning Rate = 0.001

TRAIN Stats
Total Loss |Smoke Loss|Fire Loss |    _______|Accuracy |Precision|Recall   |F1       |
-----------|----------|----------|    Smoke  |0.5875   |0.5516   |0.8371   |0.6650   |
76.77      |39.17     |37.60     |    Fire   |0.7078   |0.5444   |0.6967   |0.6112   |

VAL Stats
Total Loss |Smoke Loss|Fire Loss |    _______|Accuracy |Precision|Recall   |F1       |
-----------|----------|----------|    Smoke  |0.4896   |0.4896   |1.0000   |0.6573   |
85.86      |41.28     |44.58     |    Fire   |0.3021   |0.3021   |1.0000   |0.4640   |

Saving model with new best validation loss: 85.8617
Saving model with best Mean F1: 0.5607

=== EPOCH 1/4 ===
Learning Rate = 0.001

TRAIN Stats
Total Loss |Smoke Loss|Fire Loss |    _______|Accuracy |Precision|Recall   |F1       |
-----------|----------|----------|    Smoke  |0.7016   |0.6694   |0.7700   |0.7162   |
69.01      |35.90     |33.11     |    Fire   |0.7812   |0.6437   |0.7536   |0.6943   |

VAL Stats
Total Loss |Smoke Loss|Fire Loss |    _______|Accuracy |Precision|Recall   |F1       |
-----------|----------|----------|    Smoke  |0.4896   |0.4896   |1.0000   |0.6573   |
89.35      |43.01     |46.34     |    Fire   |0.3021   |0.3021   |1.0000   |0.4640   |


=== EPOCH 2/4 ===
Learning Rate = 0.001

TRAIN Stats
Total Loss |Smoke Loss|Fire Loss |    _______|Accuracy |Precision|Recall   |F1       |
-----------|----------|----------|    Smoke  |0.7250   |0.6997   |0.7668   |0.7317   |
64.54      |34.11     |30.43     |    Fire   |0.8250   |0.7162   |0.7773   |0.7455   |

VAL Stats
Total Loss |Smoke Loss|Fire Loss |    _______|Accuracy |Precision|Recall   |F1       |
-----------|----------|----------|    Smoke  |0.4896   |0.4896   |1.0000   |0.6573   |
96.62      |47.19     |49.43     |    Fire   |0.3151   |0.3061   |1.0000   |0.4687   |

Saving model with best Mean F1: 0.5630

=== EPOCH 3/4 ===
Learning Rate = 0.001

TRAIN Stats
Total Loss |Smoke Loss|Fire Loss |    _______|Accuracy |Precision|Recall   |F1       |
-----------|----------|----------|    Smoke  |0.7109   |0.6975   |0.7220   |0.7096   |
62.64      |32.82     |29.82     |    Fire   |0.8062   |0.6968   |0.7299   |0.7130   |

VAL Stats
Total Loss |Smoke Loss|Fire Loss |    _______|Accuracy |Precision|Recall   |F1       |
-----------|----------|----------|    Smoke  |0.5104   |0.5000   |0.9681   |0.6594   |
91.86      |48.87     |42.99     |    Fire   |0.6016   |0.4232   |0.8793   |0.5714   |

Saving model with best Mean F1: 0.6154

=== EPOCH 4/4 ===
Learning Rate = 0.0008

TRAIN Stats
Total Loss |Smoke Loss|Fire Loss |    _______|Accuracy |Precision|Recall   |F1       |
-----------|----------|----------|    Smoke  |0.7188   |0.7180   |0.6997   |0.7087   |
59.72      |31.78     |27.94     |    Fire   |0.8391   |0.7547   |0.7583   |0.7565   |

VAL Stats
Total Loss |Smoke Loss|Fire Loss |    _______|Accuracy |Precision|Recall   |F1       |
-----------|----------|----------|    Smoke  |0.6562   |0.6138   |0.8032   |0.6959   |
68.58      |37.15     |31.43     |    Fire   |0.7786   |0.6013   |0.7931   |0.6840   |

Saving model with new best validation loss: 68.5807
Saving model with best Mean F1: 0.6899
Saving last model

***Script finished: 03:29:23

Time elapsed: 0:00:25.415028

Testing with FULL TEST LOADER
{'Accuracy': [0.65625, 0.7786458134651184], 'Precision': [0.6138211488723755, 0.601307213306427], 'Recall': [0.8031914830207825, 0.7931034564971924], 'F1': [0.695852518081665, 0.6840148568153381]}
