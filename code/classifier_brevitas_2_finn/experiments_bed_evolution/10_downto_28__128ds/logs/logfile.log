BED_Downto_28.
	One Head.
	Weighted for Precision.
	Dataset images divided by 255.

Training Brevitas Model = False

Datasets Length
	Train and Val: 128

Load Model: False

Device: cuda
Optimizer:
	Learning Rate: 0.001
	Weight Decay: 0.001
Scheduler:
	Scheduler factor: 0.8
	Scheduler patience: 2
	Scheduler threshold: 0.001
	Scheduler min learning rate: 1e-06

Batch Size: 64
Num Workers: 8
Pin Memory: True
Epochs: 5

IMG DIMS:
	Width: 224
	Height: 224

Brevitas Config:
	Fixed Point: True
	Weights Bit Width: 4
	Big Layers Weights Bit Width: 2
	Bias Bit Width: 4
	Activations Bit Width: 4

Trainable parameters = 93266
Total parameters = 93266

==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
BED_CLASSIFIER_DOWNTO_28                 [1, 2]                    --
├─Sequential: 1-1                        [1, 2]                    --
│    └─Conv2d: 2-1                       [1, 32, 224, 224]         864
│    └─BatchNorm2d: 2-2                  [1, 32, 224, 224]         64
│    └─ReLU: 2-3                         [1, 32, 224, 224]         --
│    └─MaxPool2d: 2-4                    [1, 32, 112, 112]         --
│    └─Conv2d: 2-5                       [1, 16, 112, 112]         4,608
│    └─BatchNorm2d: 2-6                  [1, 16, 112, 112]         32
│    └─ReLU: 2-7                         [1, 16, 112, 112]         --
│    └─MaxPool2d: 2-8                    [1, 16, 56, 56]           --
│    └─Conv2d: 2-9                       [1, 16, 56, 56]           256
│    └─BatchNorm2d: 2-10                 [1, 16, 56, 56]           32
│    └─ReLU: 2-11                        [1, 16, 56, 56]           --
│    └─Conv2d: 2-12                      [1, 32, 56, 56]           4,608
│    └─BatchNorm2d: 2-13                 [1, 32, 56, 56]           64
│    └─ReLU: 2-14                        [1, 32, 56, 56]           --
│    └─Conv2d: 2-15                      [1, 32, 56, 56]           1,024
│    └─BatchNorm2d: 2-16                 [1, 32, 56, 56]           64
│    └─ReLU: 2-17                        [1, 32, 56, 56]           --
│    └─Conv2d: 2-18                      [1, 64, 56, 56]           18,432
│    └─BatchNorm2d: 2-19                 [1, 64, 56, 56]           128
│    └─ReLU: 2-20                        [1, 64, 56, 56]           --
│    └─MaxPool2d: 2-21                   [1, 64, 28, 28]           --
│    └─Conv2d: 2-22                      [1, 32, 28, 28]           2,048
│    └─BatchNorm2d: 2-23                 [1, 32, 28, 28]           64
│    └─ReLU: 2-24                        [1, 32, 28, 28]           --
│    └─Conv2d: 2-25                      [1, 64, 28, 28]           18,432
│    └─BatchNorm2d: 2-26                 [1, 64, 28, 28]           128
│    └─ReLU: 2-27                        [1, 64, 28, 28]           --
│    └─Conv2d: 2-28                      [1, 32, 28, 28]           2,048
│    └─BatchNorm2d: 2-29                 [1, 32, 28, 28]           64
│    └─ReLU: 2-30                        [1, 32, 28, 28]           --
│    └─Conv2d: 2-31                      [1, 64, 28, 28]           18,432
│    └─BatchNorm2d: 2-32                 [1, 64, 28, 28]           128
│    └─ReLU: 2-33                        [1, 64, 28, 28]           --
│    └─Conv2d: 2-34                      [1, 32, 28, 28]           2,048
│    └─BatchNorm2d: 2-35                 [1, 32, 28, 28]           64
│    └─ReLU: 2-36                        [1, 32, 28, 28]           --
│    └─Conv2d: 2-37                      [1, 64, 28, 28]           18,432
│    └─BatchNorm2d: 2-38                 [1, 64, 28, 28]           128
│    └─ReLU: 2-39                        [1, 64, 28, 28]           --
│    └─AdaptiveAvgPool2d: 2-40           [1, 64, 1, 1]             --
│    └─Flatten: 2-41                     [1, 64]                   --
│    └─Linear: 2-42                      [1, 16]                   1,040
│    └─ReLU: 2-43                        [1, 16]                   --
│    └─Linear: 2-44                      [1, 2]                    34
==========================================================================================
Total params: 93,266
Trainable params: 93,266
Non-trainable params: 0
Total mult-adds (M): 225.59
==========================================================================================
Input size (MB): 0.60
Forward/backward pass size (MB): 39.74
Params size (MB): 0.37
Estimated Total Size (MB): 40.71
==========================================================================================

Loss Function: BCE
Smoke Precision Weight: 0.8
Starting script


***Start Training: 12:55:19


=== EPOCH 0/4 ===
Learning Rate = 0.001

TRAIN Stats
Total Loss |Smoke Loss|Fire Loss |    _______|Accuracy |Precision|Recall   |F1       |
-----------|----------|----------|    Smoke  |0.5688   |0.6095   |0.3291   |0.4274   |
78.19      |39.05     |39.15     |    Fire   |0.6828   |0.7857   |0.0521   |0.0978   |

VAL Stats
Total Loss |Smoke Loss|Fire Loss |    _______|Accuracy |Precision|Recall   |F1       |
-----------|----------|----------|    Smoke  |0.5104   |0.0000   |0.0000   |0.0000   |
82.34      |39.68     |42.66     |    Fire   |0.6979   |0.0000   |0.0000   |0.0000   |

Saving model with new best validation loss: 82.3385

=== EPOCH 1/4 ===
Learning Rate = 0.001

TRAIN Stats
Total Loss |Smoke Loss|Fire Loss |    _______|Accuracy |Precision|Recall   |F1       |
-----------|----------|----------|    Smoke  |0.6234   |0.6429   |0.5176   |0.5735   |
72.76      |38.20     |34.56     |    Fire   |0.7906   |0.8468   |0.4455   |0.5839   |

VAL Stats
Total Loss |Smoke Loss|Fire Loss |    _______|Accuracy |Precision|Recall   |F1       |
-----------|----------|----------|    Smoke  |0.4896   |0.4896   |1.0000   |0.6573   |
87.48      |40.44     |47.04     |    Fire   |0.3073   |0.3037   |1.0000   |0.4659   |

Saving model with best Mean F1: 0.5616

=== EPOCH 2/4 ===
Learning Rate = 0.001

TRAIN Stats
Total Loss |Smoke Loss|Fire Loss |    _______|Accuracy |Precision|Recall   |F1       |
-----------|----------|----------|    Smoke  |0.6687   |0.7012   |0.5623   |0.6241   |
68.50      |37.30     |31.20     |    Fire   |0.8062   |0.8321   |0.5166   |0.6374   |

VAL Stats
Total Loss |Smoke Loss|Fire Loss |    _______|Accuracy |Precision|Recall   |F1       |
-----------|----------|----------|    Smoke  |0.4896   |0.4896   |1.0000   |0.6573   |
89.01      |41.25     |47.76     |    Fire   |0.4375   |0.3276   |0.8190   |0.4680   |

Saving model with best Mean F1: 0.5627

=== EPOCH 3/4 ===
Learning Rate = 0.001

TRAIN Stats
Total Loss |Smoke Loss|Fire Loss |    _______|Accuracy |Precision|Recall   |F1       |
-----------|----------|----------|    Smoke  |0.6547   |0.6983   |0.5176   |0.5945   |
66.14      |36.75     |29.39     |    Fire   |0.8125   |0.8227   |0.5498   |0.6591   |

VAL Stats
Total Loss |Smoke Loss|Fire Loss |    _______|Accuracy |Precision|Recall   |F1       |
-----------|----------|----------|    Smoke  |0.5573   |0.5281   |0.8989   |0.6654   |
72.06      |39.63     |32.43     |    Fire   |0.7969   |0.6439   |0.7328   |0.6855   |

Saving model with new best validation loss: 72.0611
Saving model with best Mean F1: 0.6754

=== EPOCH 4/4 ===
Learning Rate = 0.001

TRAIN Stats
Total Loss |Smoke Loss|Fire Loss |    _______|Accuracy |Precision|Recall   |F1       |
-----------|----------|----------|    Smoke  |0.6625   |0.6790   |0.5879   |0.6301   |
63.55      |35.82     |27.73     |    Fire   |0.8188   |0.7879   |0.6161   |0.6915   |

VAL Stats
Total Loss |Smoke Loss|Fire Loss |    _______|Accuracy |Precision|Recall   |F1       |
-----------|----------|----------|    Smoke  |0.6146   |0.5758   |0.8085   |0.6726   |
67.45      |37.74     |29.71     |    Fire   |0.8047   |0.6990   |0.6207   |0.6575   |

Saving model with new best validation loss: 67.4519
Saving last model

***Script finished: 12:55:44

Time elapsed: 0:00:25.585030

Testing with FULL TEST LOADER
{'Accuracy': [0.5572916865348816, 0.796875], 'Precision': [0.528124988079071, 0.6439393758773804], 'Recall': [0.8989361524581909, 0.732758641242981], 'F1': [0.665354311466217, 0.6854838728904724]}
